<app-navbar></app-navbar>
    <div class="container py-4">
      <div *ngIf="loading" class="text-center py-5">
        <div class="spinner-border text-primary"></div>
      </div>

      <div *ngIf="!loading && referralInfo">
        <div class="row g-4 mb-4">
          <div class="col-md-6">
            <div class="card shadow h-100">
              <div class="card-header bg-primary text-white">
                <h5 class="mb-0">Your Referral Link</h5>
              </div>
              <div class="card-body">
                <p class="text-muted">Share this link to earn referral income:</p>
                <div class="input-group">
                  <input type="text" class="form-control" [value]="referralInfo.referralLink" readonly #linkInput>
                  <button class="btn btn-primary" (click)="copyLink(linkInput)">Copy</button>
                </div>
                <div class="mt-3">
                  <span class="badge bg-primary fs-5">{{ referralInfo.referralCode }}</span>
                </div>
                <div *ngIf="copied" class="text-success mt-2">Link copied!</div>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="card shadow h-100">
              <div class="card-header bg-success text-white">
                <h5 class="mb-0">Referral Stats</h5>
              </div>
              <div class="card-body">
                <div class="row text-center">
                  <div class="col-4">
                    <h3 class="text-primary mb-0">{{ referralInfo.directReferrals }}</h3>
                    <small class="text-muted">Direct</small>
                  </div>
                  <div class="col-4">
                    <h3 class="text-info mb-0">{{ referralInfo.totalReferrals }}</h3>
                    <small class="text-muted">Total Team</small>
                  </div>
                  <div class="col-4">
                    <h3 class="text-success mb-0">{{ referralInfo.totalEarnings | number:'1.2-2' }}</h3>
                    <small class="text-muted">Earnings</small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="card shadow mb-4">
          <div class="card-header bg-info text-white">
            <h5 class="mb-0">Commission Structure (15 Levels)</h5>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-bordered text-center">
                <thead class="table-light">
                  <tr>
                    <th>Level</th>
                    <th>Deposit Commission</th>
                    <th>Winner Commission</th>
                    <th>Requirement</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td>1</td><td>5%</td><td>5%</td><td>1 Direct</td></tr>
                  <tr><td>2</td><td>2%</td><td>2%</td><td>2 Directs</td></tr>
                  <tr><td>3-5</td><td>1%</td><td>1%</td><td>3-5 Directs</td></tr>
                  <tr><td>6-15</td><td>0.5%</td><td>0.5%</td><td>6-10 Directs</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="card shadow">
          <div class="card-header bg-secondary text-white">
            <h5 class="mb-0">Direct Referrals</h5>
          </div>
          <div class="card-body">
            <div *ngIf="referralInfo.directMembers.length === 0" class="text-center text-muted py-4">
              No referrals yet. Share your link to start earning!
            </div>

            <div class="table-responsive" *ngIf="referralInfo.directMembers.length > 0">
              <table class="table table-hover">
                <thead class="table-light">
                  <tr>
                    <th>Username</th>
                    <th>Joined</th>
                    <th>Deposits</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let member of referralInfo.directMembers">
                    <td>{{ member.username }}</td>
                    <td>{{ member.joinedAt | date:'mediumDate' }}</td>
                    <td>{{ member.deposits | number:'1.2-2' }} USDT</td>
                    <td>
                      <span class="badge" [class]="member.activated ? 'bg-success' : 'bg-warning'">
                        {{ member.activated ? 'Active' : 'Pending' }}
                      </span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>