# Render Blueprint - TRK Blockchain dApp
# https://render.com/docs/blueprint-spec
#
# This is a DECENTRALIZED application. Only the frontend is required.
# The backend is OPTIONAL and can be used for event indexing/analytics.

services:
  # Frontend - Angular Static Site (REQUIRED)
  # This is the only service needed for the dApp to function
  - type: web
    name: trk-blockchain-frontend
    runtime: static
    buildCommand: cd frontend/trk-blockchain && npm install && npm run build -- --configuration=production
    staticPublishPath: ./frontend/trk-blockchain/dist/trk-blockchain/browser
    region: oregon
    plan: free
    headers:
      - path: /*
        name: Cache-Control
        value: public, max-age=31536000, immutable
      - path: /index.html
        name: Cache-Control
        value: no-cache
    routes:
      - type: rewrite
        source: /*
        destination: /index.html

  # Backend - Spring Boot API (OPTIONAL - Indexer/Analytics only)
  # Uncomment the section below if you need event indexing or analytics
  # The dApp works WITHOUT this service - all core functionality is on-chain
  #
  # - type: web
  #   name: trk-blockchain-api
  #   runtime: docker
  #   dockerfilePath: ./backend/Dockerfile
  #   dockerContext: ./backend
  #   region: oregon
  #   plan: free
  #   envVars:
  #     - key: SPRING_PROFILES_ACTIVE
  #       value: prod
  #     - key: PORT
  #       value: 8080
  #     - key: CORS_ALLOWED_ORIGINS
  #       value: https://trk-blockchain-frontend.onrender.com
  #     # Add these for blockchain indexing:
  #     # - key: BSC_RPC_URL
  #     #   value: https://bsc-dataseed.binance.org/
  #     # - key: CONTRACT_TRK
  #     #   value: 0x...
